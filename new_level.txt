
==== the new flow =====
Vendor Module: Admin-Led Registration and Access
This section defines the direct process for the State Admin to onboard vendors and the resultant user structure.

1. Vendor Registration and Account Creation (State Admin Action)
The State Admin maintains full control over the creation of the official Vendor entity and its primary user accounts.

Step	Actor	Action on the Platform/Dashboard	System Impact
1. Official Registration	State Admin	Navigates to the "Vendor Management" module. Clicks "Register New Vendor." Fills in official details (Company Name, contact, banking details, etc.).	A permanent record is created in the Vendor model.
2. Primary User Creation	State Admin	Within the same screen, the Admin creates the initial, high-privilege user account for the vendor (e.g., the Vendor Manager). The Admin sets the initial authentication credentials (username/email and temporary password).	An entry is created in the users table, linked to the new Vendor record via vendor_id, and assigned the Vendor Manager role.
3. Account Activation	State Admin	Completes registration, triggering an email/SMS notification to the vendor with their credentials and login link.	The Vendor Manager can now authenticate and access their dashboard.

Export to Sheets

2. Vendor Authentication and Sub-Account Management
Vendors can manage their own internal team structure after they are onboarded.

Component	Role	Access/Creation Rights	Core Responsibilities & Dashboard Focus
Primary Account	Vendor Manager	Created by State Admin. Has rights to create/manage Sub-Accounts.	Oversight, Financials, and Proposals: View all analytics, manage Sub-Accounts, initiate resource proposals, and request wallet payouts.
Sub-Account	Distribution Agent	Created by Vendor Manager (or State Admin for highly controlled scenarios).	Fulfillment Execution: Can only search for farmers, view payment status, and click the "FULFILLED" button at the Point of Collection (POC).
Admin Oversight	SuperAdmin/State Admin	Has full, read-write rights across ALL vendor activities, sub-accounts, resource proposals, and financial logs.	Full System Audit: Can oversee all transactions, fulfillment logs, and sub-account actions across all vendors for compliance.

Export to Sheets

Resource Creation and Allocation Flow
The resource flow must accommodate the vendor's ability to propose items while retaining the State Admin's final control.

1. Vendor Resource Proposal (Vendor Action)
Vendors can create resources anytime, initiating the process from their dashboard.

Step	Actor	Action on the Platform/Dashboard	System Logic
1. Proposal Creation	Vendor Manager	Navigates to "Resource Management." Clicks "Propose New Resource." Fills in all details: Resource Type (e.g., Seed), Co-Payment Price, Vendor Reimbursement Price, Proposed Max per Farmer, Total Stock, etc.	The resource record is created in the resources table with an initial status of Proposed.
2. Submission	Vendor Manager	Submits the proposal for review.	The State Admin receives a notification: "Vendor X has submitted a resource proposal."

Export to Sheets

2. Resource Vetting and Publishing (State Admin Control)
The State Admin acts as the gatekeeper, controlling what resources are published to farmers.

Step	Actor	Action on the Platform/Dashboard	System Logic
1. Review & Vetting	State Admin	Views the Proposed resource details. Can edit parameters (e.g., reduce the Max per Farmer or adjust the Co-Payment Price) or approve/decline the resource.	Vetting is Centralized: Ensures all proposals align with state subsidy policies and quality standards.
2. Publishing	State Admin	Sets the resource status to Published/Active and defines the Allocation Criteria (e.g., splitting stock across LGAs).	Farmer Visibility: The resource becomes visible on the Farmer Dashboard, allowing farmers to "Apply/Put Up For" it.

Export to Sheets

This revised flow ensures that the State Admin is the ultimate authority in both vendor onboarding and resource availability, while providing vendors with the necessary tools to manage their operations and propose new business opportunities.






==== resources flow =====
1. Resource Setup and Farmer Entitlement (The Allocation Ceiling)
The State Admin defines the resource and its rules.

Stakeholder	Action on the Platform/Dashboard	Status Update & Logic
State Admin	1. Creates a Resource (e.g., Certified Seed or Tractor Service). 2. Sets Co-Payment Price Per Unit (e.g., NGN 10,000/unit). 3. Sets the Maximum Entitlement Per Farmer (e.g., 5 units). 4. Approves Vendors for this resource.	Resource is "Available for Application." The maximum entitlement is the ceiling, not a commitment.
Farmer	Logs in, sees available resources, and clicks "Apply/Put Up For."	Status updates to "Application Pending."
State Admin	Reviews applications and sets the status to "Approved."	Farmer's dashboard now shows: "Approved: Max Entitlement 5 Units." Vendor's dashboard now shows the farmer as Eligible.

Export to Sheets

2. Payment and Final Quantity Lock (Single Transaction)
The farmer determines the final quantity they wish to pay for at the POC, and the payment locks the fulfillment record.

Step	Stakeholder Action on the Platform/Dashboard	Payment/System Logic	System Record (Audit)
1. Session Initiation	Vendor: Searches for the farmer using their NIN/ID. Vendor Dashboard displays: Farmer Profile, Remaining Entitlement (5 Units), and Unit Price (NGN 10,000).	The vendor verbally advises the farmer of their limit (5) and stock status.	—
2. Farmer Quantity Choice	Farmer: Accesses their dashboard. The status is "Payment Due." The farmer inputs the Quantity to Pay For (e.g., enters 3 units). The system calculates:	
3 units×NGN 10,000/unit=NGN 30,000
System Logic: Payable Amount is locked at NGN 30,000.	Farmer's payment status is "Payment in Progress."
3. Digital Payment & Split	Farmer: Completes the mandatory digital payment (NGN 30,000).	Split Payment: The gateway instantly splits the NGN 30,000: Vendor (NGN 30,000 - Service Charge) and System (Service Charge).	Status: Transaction is "PAID: 3 UNITS." Vendor's dashboard instantly updates.

Export to Sheets

3. Final Fulfillment and Record Closure (The Critical Step)
This step incorporates the "fulfillment is done once" rule.

Step	Stakeholder Action on the Platform/Dashboard	Fulfillment Logic	Final System Record
1. Delivery	Vendor: Delivers the 3 paid units to the farmer.	—	—
2. Fulfillment Lock	Vendor: On their dashboard, they click the "FULFILLED" button for the farmer's "PAID: 3 UNITS" record. (Crucial) The vendor does NOT input quantity here; they confirm the quantity already paid for.	Fulfillment Finality Rule: The system locks the entire resource allocation for this farmer as CLOSED/CONSUMED.	Farmer Status: "FULFILLED: 3 UNITS (CLOSED)." Admin Record: 3 units are added to the Vendor's subsidy reimbursement claim count.
3. Entitlement Update	—	System Logic: Farmer's entitlement is reduced by the FULL MAX ENTITLEMENT (e.g., from 5 to 0), regardless of the 2 units not collected.	Farmer's Entitlement: 0 Units Remaining.

Export to Sheets

Rationale for Finality
By setting the rule that fulfillment closes the record, you achieve the following:

Vendor Accountability: The vendor is incentivized to provide the maximum available stock because they lose the opportunity for the subsidy on the remaining units once they tick "Fulfilled."

Administrative Simplicity: The State Admin never has to track and reconcile partial entitlements. A farmer either fully utilizes the system's subsidy access or their single fulfillment action closes their file for that resource.

Clear Audit Trail: The Ministry only reimburses based on the PAID and FULFILLED count. The finality simplifies the audit from a "remaining balance" check to a simple "fulfilled count" reimbursement.




